# 띠별운세 시스템 재설계 문서

**작성일:** 2025-10-14
**프로젝트:** BAAL - 띠별운세
**목적:** 60갑자 기반 체계적 데이터베이스 구축 및 윤리적 콘텐츠 생성

---

## 📋 목차
1. [제0원칙: 콘텐츠 윤리 가이드라인](#제0원칙-콘텐츠-윤리-가이드라인)
2. [현재 문제점](#현재-문제점)
3. [재설계 목표](#재설계-목표)
4. [데이터 계층 구조](#데이터-계층-구조)
5. [JSON 스키마 정의](#json-스키마-정의)
6. [폴더 구조](#폴더-구조)
7. [에이전트 시스템](#에이전트-시스템)
8. [작업 로드맵](#작업-로드맵)

---

## 제0원칙: 콘텐츠 윤리 가이드라인

### 🚨 절대 금지 사항
**사용자 직접 인용:**
> "부정적 언어, 무언가 남녀차별적, 정치편향적, 종교적 등등 문제가 생길수 있는 문구들을 절대 넣지 않아야해"
> "재미있고 유쾌하고, 위안을 주고 희망을 주는 컨셉으로 가야함"

이 원칙은 **모든 설계와 구현에 우선**합니다.

### 1. 절대 금지 표현 카테고리

#### ❌ 부정적 언어
- "불행", "재앙", "망하다", "실패", "불운"
- "조심하세요", "위험합니다", "피하세요"
- "나쁜 일이 생길 수 있습니다"

#### ❌ 성차별적 표현
- "남자답게", "여자답게"
- "이성의 ○○이 ○○한다"
- 성별 고정관념 (요리/육아=여성, 사업/리더십=남성)

#### ❌ 정치 편향
- 특정 정당/정치인 언급
- 좌파/우파 이념 표현
- 정치적 사안에 대한 판단

#### ❌ 종교 편향
- 특정 종교 우월주의
- "신의 가호", "부처님의 은총" 등 특정 종교 용어
- 종교 간 비교/우열

#### ❌ 차별적 표현
- 학력/직업/지역/나이 차별
- "○○출신", "○○대 나온"
- 외모/신체 관련 차별

### 2. 긍정 프레이밍 원칙

#### ✅ 대안 표현 예시

| 금지 표현 | 긍정 프레이밍 |
|---------|------------|
| "조심하세요" | "신중한 선택이 빛을 발하는 시기예요" |
| "실패할 수 있어요" | "새로운 시도로 배움을 얻는 시간이에요" |
| "불운한 날" | "평온함을 즐기기 좋은 날" |
| "피하세요" | "다른 길을 탐색해보세요" |
| "남자답게 결단" | "용기 있는 결단" |
| "여자의 직관" | "섬세한 직관" |

#### ✅ 필수 톤 앤 매너
1. **유쾌함**: 재미있고 가벼운 말투
2. **위안**: 따뜻하고 공감적인 어조
3. **희망**: 미래 지향적, 긍정적 전망
4. **포용**: 모든 독자가 환영받는 느낌
5. **중립**: 성별/나이/직업 무관한 표현

### 3. 검증 체크리스트

모든 콘텐츠는 다음을 통과해야 합니다:

```
□ 부정 단어 0개
□ 성별 고정관념 0개
□ 정치/종교 언급 0개
□ 차별 표현 0개
□ 긍정적 느낌 전달
□ 유쾌한 톤
□ 위안/희망 제공
```

### 4. 에이전트별 책임

#### 철학자 에이전트
- 동양철학 원리 검증
- 음양오행 논리 확인
- **윤리 기준 1차 검증**

#### 국문학자 에이전트
- 긍정 프레이밍 변환
- 유쾌/위안/희망 톤 구현
- **윤리 기준 2차 검증**

#### 검증 에이전트 (신설)
- 금지 표현 자동 탐지
- 체크리스트 최종 확인
- **윤리 기준 3차 검증**

---

## 현재 문제점

### 1. 데이터 구조 문제
- ❌ 60갑자 시스템 부재
- ❌ 출생년도별 차이 없음 (모두 랜덤)
- ❌ 일일/주간/월간/년간/평생 운세 차별화 없음

### 2. 궁합 시스템 문제
- ❌ 궁합 매트릭스 75% 누락 (12개 중 3개만)
- ❌ 없는 조합은 랜덤 반환 (50-90점)
- ❌ 일관성 없음

### 3. 속성 데이터 문제
- ❌ 행운의 숫자/색 매번 랜덤 생성
- ❌ 같은 사용자가 새로고침하면 다른 결과
- ❌ 신뢰성 저하

### 4. 콘텐츠 품질 문제
- ❌ 생성 정보 사용 (검증 안 됨)
- ❌ 동양철학 검증 부재
- ❌ 문체 일관성 없음

### 5. 코드 구조 문제
- ❌ 데이터와 로직 혼재
- ❌ 하드코딩 많음
- ❌ 유지보수 어려움

---

## 재설계 목표

### 1. 체계적 데이터베이스
- ✅ 60갑자 시스템 완전 구현 (1900-2100년)
- ✅ 출생년도별 고유 속성 부여
- ✅ 일관된 행운의 숫자/색

### 2. 완전한 궁합 시스템
- ✅ 12×12 = 144개 조합 완성
- ✅ 상생상극 논리 기반
- ✅ 일관된 결과

### 3. 검증된 콘텐츠
- ✅ 웹 조사 기반 실제 데이터
- ✅ 철학자 에이전트 검증
- ✅ 국문학자 에이전트 다듬기
- ✅ **윤리 기준 3단계 검증**

### 4. 깔끔한 코드 구조
- ✅ 데이터/로직 완전 분리
- ✅ JSON 기반 데이터 관리
- ✅ 모듈화된 JavaScript

---

## 데이터 계층 구조

```
레벨 0 (불변): 기초 철학 원리
├─ 오행 (5개): 木火土金水
├─ 천간 (10개): 갑을병정무기경신임계
└─ 지지 (12개): 자축인묘진사오미신유술해

레벨 1 (불변): 관계 정의
├─ 상생상극 (오행 관계)
├─ 궁합 매트릭스 (12×12)
└─ 속성 매핑 (60갑자 → 오행)

레벨 2 (변동): 년도별 데이터
├─ 60갑자 매핑 (1900-2100)
├─ 년도별 키워드 (2025년...)
└─ 세시풍속 데이터

레벨 3 (동적): 생성 콘텐츠
├─ 운세 문구 템플릿
├─ 조합 로직
└─ 최종 결과 생성
```

---

## JSON 스키마 정의

### 1. elements.json (오행)
```json
{
  "elements": [
    {
      "id": "wood",
      "name_kr": "목(木)",
      "name_en": "Wood",
      "color": "청록색",
      "season": "봄",
      "direction": "동",
      "personality": [
        "창의적", "성장 지향적", "유연함", "포용력"
      ],
      "lucky_numbers": [3, 8],
      "lucky_colors": ["청록", "초록"]
    }
    // ... 화토금수
  ]
}
```

### 2. sexagenary.json (60갑자) - 핵심!
```json
{
  "sexagenary_cycle": [
    {
      "id": 1,
      "heavenly_stem": "갑(甲)",
      "earthly_branch": "자(子)",
      "name": "갑자",
      "element": "wood",
      "zodiac": "rat",
      "yin_yang": "양",
      "personality_traits": [
        "창의적", "지혜로움", "기민함"
      ],
      "lucky_numbers": [1, 4, 7],
      "lucky_colors": ["파랑", "검정", "초록"],
      "compatible_elements": ["water", "wood"],
      "years": [1924, 1984, 2044]
    }
    // ... 60개 (갑자 ~ 계해)
  ],
  "year_mapping": {
    "1924": 1,
    "1984": 1,
    "2044": 1,
    // ... 1900-2100년 전체 매핑
  }
}
```

### 3. element_relations.json (상생상극)
```json
{
  "mutual_generation": {
    "wood": "fire",
    "fire": "earth",
    "earth": "metal",
    "metal": "water",
    "water": "wood"
  },
  "mutual_conquest": {
    "wood": "earth",
    "earth": "water",
    "water": "fire",
    "fire": "metal",
    "metal": "wood"
  },
  "compatibility_scores": {
    "generation": 90,
    "same": 80,
    "neutral": 70,
    "conquest": 50
  }
}
```

### 4. compatibility_matrix.json (12×12)
```json
{
  "matrix": {
    "rat": {
      "rat": {"score": 85, "reason": "이해도 높음", "keywords": ["공감", "협력"]},
      "ox": {"score": 90, "reason": "상호 보완", "keywords": ["안정", "신뢰"]},
      // ... 12개
    },
    // ... 12개 띠 전체
  }
}
```

### 5. fortune_2025.json (년도별)
```json
{
  "year": 2025,
  "year_element": "wood",
  "year_zodiac": "snake",
  "year_keywords": [
    "변화", "성장", "지혜", "새로운 시작"
  ],
  "monthly_themes": {
    "1": "새로운 계획의 시작",
    "2": "인연의 확장",
    // ... 12개월
  },
  "zodiac_specific": {
    "rat": {
      "yearly": {
        "theme": "도약의 해",
        "focus": ["커리어", "인간관계"],
        "opportunities": [
          "새로운 프로젝트 기회",
          "의미 있는 만남"
        ]
      },
      "monthly": {
        "1": "활기찬 시작",
        // ... 12개월
      }
    }
    // ... 12개 띠
  }
}
```

### 6. fortune_templates.json (문구 템플릿)
```json
{
  "templates": {
    "daily": {
      "positive_high": [
        "오늘은 {키워드1}한 에너지가 가득한 날이에요! {행동1}를 시도해보세요.",
        "밝은 기운이 함께하는 하루예요. {키워드2}에 집중하면 좋아요."
      ],
      "positive_medium": [
        "평온한 하루를 보낼 수 있어요. {행동2}를 즐겨보세요.",
        "차분하게 {키워드3}를 돌아보기 좋은 시간이에요."
      ]
    },
    "compatibility": {
      "excellent": [
        "환상의 조합이에요! 서로를 {키워드1}하며 {결과1}을 만들어가요.",
        "최고의 파트너예요! {공통점1}을 바탕으로 {미래1}를 그려갈 수 있어요."
      ],
      "good": [
        "좋은 궁합이에요! {강점1}을 살리면 {결과2}할 수 있어요.",
        "서로를 {동사1}하며 성장할 수 있는 관계예요."
      ]
    }
  },
  "keywords": {
    "positive": [
      "밝은", "유쾌한", "따뜻한", "활기찬", "평온한",
      "창의적인", "지혜로운", "용기 있는"
    ],
    "actions": [
      "새로운 시도", "소통", "휴식", "계획 세우기",
      "취미 활동", "친구 만나기"
    ]
  }
}
```

---

## 폴더 구조

```
/zodiac-fortune/
├── index.html                      (기존)
├── style.css                       (기존)
├── script.js                       (유지, 추후 분리)
│
├── /data/                          (신규)
│   ├── /base/                      (레벨 0-1: 불변 데이터)
│   │   ├── elements.json           (오행 5개)
│   │   ├── sexagenary.json         (60갑자, 1900-2100년 매핑)
│   │   └── zodiac.json             (12띠 기본 정보)
│   │
│   ├── /relations/                 (레벨 1: 관계 데이터)
│   │   ├── element_relations.json  (상생상극)
│   │   └── compatibility_matrix.json (12×12 궁합)
│   │
│   └── /fortune/                   (레벨 2-3: 동적 데이터)
│       ├── 2025.json               (2025년 운세 데이터)
│       ├── templates.json          (문구 템플릿)
│       └── messages.json           (메시지 라이브러리)
│
├── /js/                            (신규, 추후 분리 시)
│   ├── core.js                     (60갑자 계산 엔진)
│   ├── fortune.js                  (운세 생성 로직)
│   └── compatibility.js            (궁합 계산 로직)
│
└── /agents/                        (신규, 프롬프트 저장)
    ├── philosopher.md              (철학자 에이전트)
    ├── writer.md                   (국문학자 에이전트)
    └── validator.md                (검증 에이전트)
```

---

## 에이전트 시스템

### 1. 철학자 에이전트 (Philosopher)

**역할**: 동양철학 관점에서 데이터 검증

**입력**:
- 60갑자 데이터
- 궁합 매트릭스
- 운세 키워드

**검증 항목**:
```
□ 오행 논리 일관성
□ 상생상극 정확성
□ 음양 균형 확인
□ 60갑자 순환 정확성
□ 부적절 표현 1차 검증
```

**출력**:
- 검증 통과/실패 보고서
- 수정 제안 (있을 시)

### 2. 국문학자 에이전트 (Writer)

**역할**: 자연스럽고 긍정적인 문체로 변환

**입력**:
- 철학자 검증 통과 데이터
- 운세 문구 초안

**변환 기준**:
```
✅ 유쾌함: 재미있고 가벼운 톤
✅ 위안: 따뜻하고 공감적
✅ 희망: 긍정적 미래 전망
✅ 포용: 모든 독자 환영
✅ 중립: 차별 표현 0개
```

**금지 표현 필터링**:
```python
FORBIDDEN = [
    "불행", "재앙", "실패", "불운",
    "남자답게", "여자답게",
    "조심하세요", "피하세요"
]
```

**출력**:
- 다듬어진 문구
- 대체 표현 제안 (3개)

### 3. 검증 에이전트 (Validator) - 신설

**역할**: 최종 윤리 기준 검증

**검증 알고리즘**:
```javascript
function validateContent(text) {
  const checks = {
    negative_words: checkNegativeWords(text),
    gender_stereotype: checkGenderStereotype(text),
    political_bias: checkPoliticalBias(text),
    religious_bias: checkReligiousBias(text),
    discrimination: checkDiscrimination(text)
  };

  return {
    passed: Object.values(checks).every(v => v === true),
    details: checks
  };
}
```

**통과 기준**:
- 모든 항목 100% 통과
- 금지 표현 0개
- 긍정 톤 점수 80점 이상

---

## 작업 로드맵

### Phase 1: 설계 확정 (1일)
- [x] 전체 설계 문서 작성
- [ ] 사용자 검토 및 승인
- [ ] JSON 스키마 최종 확정

### Phase 2: 데이터 수집 (3일)
**Day 1**: 기초 데이터
- [ ] 60갑자 데이터 수집 (1900-2100년)
- [ ] 오행 속성 정리
- [ ] 상생상극 관계 정리

**Day 2**: 관계 데이터
- [ ] 12×12 궁합 매트릭스 수집
- [ ] 웹 조사 (신뢰할 수 있는 출처)
- [ ] 철학자 에이전트 1차 검증

**Day 3**: 콘텐츠 데이터
- [ ] 2025년 운세 키워드 수집
- [ ] 월간 테마 정리
- [ ] 문구 템플릿 초안 작성

### Phase 3: 에이전트 프롬프트 작성 (1일)
- [ ] philosopher.md 작성
- [ ] writer.md 작성 (윤리 가이드라인 포함)
- [ ] validator.md 작성

### Phase 4: 데이터 생성 (3일)
**Day 1**: 기초 JSON
- [ ] elements.json 작성
- [ ] sexagenary.json 작성
- [ ] zodiac.json 작성

**Day 2**: 관계 JSON
- [ ] element_relations.json 작성
- [ ] compatibility_matrix.json 작성
- [ ] 철학자 에이전트로 검증

**Day 3**: 운세 JSON
- [ ] fortune_2025.json 작성
- [ ] templates.json 작성
- [ ] messages.json 작성
- [ ] 국문학자 에이전트로 다듬기
- [ ] 검증 에이전트로 최종 확인

### Phase 5: 코드 개선 (2일)
**Day 1**: 로직 분리
- [ ] script.js → core.js 분리
- [ ] fortune.js 작성
- [ ] compatibility.js 작성

**Day 2**: 통합 및 테스트
- [ ] 데이터 로딩 로직 구현
- [ ] 기존 UI와 연결
- [ ] 전체 기능 테스트

### Phase 6: 검증 및 배포 (2일)
**Day 1**: 품질 검증
- [ ] 모든 조합 테스트 (12×12)
- [ ] 년도별 일관성 확인
- [ ] 윤리 기준 최종 검증

**Day 2**: 배포
- [ ] GitHub Pages 업데이트
- [ ] 문서 정리
- [ ] 완료 보고서 작성

---

## 다음 단계

1. **사용자 승인 대기**
   - 이 설계 문서 검토
   - 윤리 가이드라인 확인
   - 추가 요구사항 반영

2. **즉시 시작 가능한 작업**
   - 60갑자 데이터 수집
   - 에이전트 프롬프트 작성
   - /data/ 폴더 구조 생성

3. **확인 필요 사항**
   - JSON 스키마 구조 승인
   - 에이전트 역할 분담 승인
   - 작업 일정 조율

---

**작성자:** Claude Code
**최종 수정:** 2025-10-14
**버전:** 2.0 (윤리 가이드라인 추가)
