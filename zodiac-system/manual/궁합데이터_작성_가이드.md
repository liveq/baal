# 별자리 궁합 데이터 작성 가이드

## 📋 목차
1. [궁합 시스템 개요](#궁합-시스템-개요)
2. [데이터 구조](#데이터-구조)
3. [궁합 조합 규칙](#궁합-조합-규칙)
4. [점수 산정 기준](#점수-산정-기준)
5. [메시지 작성 가이드](#메시지-작성-가이드)
6. [검증 방법](#검증-방법)

---

## 궁합 시스템 개요

### 궁합의 정의
두 별자리 간의 관계 적합도를 애정, 우정, 업무 세 가지 영역에서 평가

### 총 궁합 쌍 수
```
12개 별자리 × 13 / 2 = 78쌍
```

**포함 관계:**
- 자기 자신과의 궁합 (1-1, 2-2, ..., 12-12): 12쌍
- 다른 별자리와의 궁합 (1-2, 1-3, ..., 11-12): 66쌍

### 데이터 저장 위치
```json
{
  "compatibility": {
    "1-1": { /* 양자리 - 양자리 */ },
    "1-2": { /* 양자리 - 황소자리 */ },
    "1-3": { /* 양자리 - 쌍둥이자리 */ },
    // ...
    "12-12": { /* 물고기자리 - 물고기자리 */ }
  }
}
```

---

## 데이터 구조

### 기본 구조
```json
{
  "totalScore": 83,
  "scores": {
    "love": 82,
    "friendship": 86,
    "work": 70
  },
  "advice": "양자리와 황소자리는 함께 성장하는 관계입니다.",
  "message": ""
}
```

### 필드 설명

| 필드 | 타입 | 범위 | 설명 |
|------|------|------|------|
| totalScore | number | 60-95 | 전체 궁합 점수 (3개 점수의 평균) |
| scores.love | number | 60-95 | 애정 궁합 점수 |
| scores.friendship | number | 60-95 | 우정 궁합 점수 |
| scores.work | number | 60-95 | 업무 궁합 점수 |
| advice | string | 1-2문장 | 핵심 조언 메시지 |
| message | string | - | (현재 미사용, 빈 문자열) |

---

## 궁합 조합 규칙

### 1. 별자리 ID
```javascript
const ZODIAC_IDS = {
  1: '양자리',
  2: '황소자리',
  3: '쌍둥이자리',
  4: '게자리',
  5: '사자자리',
  6: '처녀자리',
  7: '천칭자리',
  8: '전갈자리',
  9: '사수자리',
  10: '염소자리',
  11: '물병자리',
  12: '물고기자리'
};
```

### 2. 궁합 키 생성 규칙

**규칙**: 작은 ID를 먼저, 큰 ID를 뒤에 배치
```javascript
// 올바른 예시
"1-2"  // 양자리 - 황소자리
"1-12" // 양자리 - 물고기자리
"5-9"  // 사자자리 - 사수자리

// 잘못된 예시 (생성하지 않음)
"2-1"  // ❌ 1-2와 중복
"12-1" // ❌ 1-12와 중복
"9-5"  // ❌ 5-9와 중복
```

**코드 예시:**
```javascript
function getCompatibilityKey(zodiacId1, zodiacId2) {
  const [smaller, larger] = zodiacId1 <= zodiacId2
    ? [zodiacId1, zodiacId2]
    : [zodiacId2, zodiacId1];
  return `${smaller}-${larger}`;
}
```

### 3. 모든 궁합 쌍 목록

#### 양자리 (1)
```
1-1, 1-2, 1-3, 1-4, 1-5, 1-6, 1-7, 1-8, 1-9, 1-10, 1-11, 1-12
```

#### 황소자리 (2)
```
2-2, 2-3, 2-4, 2-5, 2-6, 2-7, 2-8, 2-9, 2-10, 2-11, 2-12
```

#### 쌍둥이자리 (3)
```
3-3, 3-4, 3-5, 3-6, 3-7, 3-8, 3-9, 3-10, 3-11, 3-12
```

#### 게자리 (4)
```
4-4, 4-5, 4-6, 4-7, 4-8, 4-9, 4-10, 4-11, 4-12
```

#### 사자자리 (5)
```
5-5, 5-6, 5-7, 5-8, 5-9, 5-10, 5-11, 5-12
```

#### 처녀자리 (6)
```
6-6, 6-7, 6-8, 6-9, 6-10, 6-11, 6-12
```

#### 천칭자리 (7)
```
7-7, 7-8, 7-9, 7-10, 7-11, 7-12
```

#### 전갈자리 (8)
```
8-8, 8-9, 8-10, 8-11, 8-12
```

#### 사수자리 (9)
```
9-9, 9-10, 9-11, 9-12
```

#### 염소자리 (10)
```
10-10, 10-11, 10-12
```

#### 물병자리 (11)
```
11-11, 11-12
```

#### 물고기자리 (12)
```
12-12
```

**총 78쌍**

---

## 점수 산정 기준

### 1. 원소(Element) 기반 기본 점수

#### 원소 분류
- **불(Fire)**: 양자리(1), 사자자리(5), 사수자리(9)
- **흙(Earth)**: 황소자리(2), 처녀자리(6), 염소자리(10)
- **바람(Air)**: 쌍둥이자리(3), 천칭자리(7), 물병자리(11)
- **물(Water)**: 게자리(4), 전갈자리(8), 물고기자리(12)

#### 원소 상성 점수 가이드

| 조합 | 애정 | 우정 | 업무 | 특징 |
|------|------|------|------|------|
| 같은 원소 | 75-85 | 80-90 | 70-80 | 이해도 높음, 비슷한 성향 |
| 불 + 바람 | 80-90 | 75-85 | 75-85 | 역동적, 활기참 |
| 흙 + 물 | 75-85 | 80-90 | 80-90 | 안정적, 신뢰감 |
| 불 + 물 | 65-75 | 70-80 | 65-75 | 긴장감, 균형 필요 |
| 흙 + 바람 | 70-80 | 75-85 | 80-90 | 보완 관계 |
| 불 + 흙 | 70-80 | 70-80 | 75-85 | 현실과 이상의 조화 |
| 바람 + 물 | 65-75 | 70-80 | 70-80 | 이성과 감성의 균형 |

### 2. 관계별 점수 조정

#### 애정 궁합 (Love)
- **강점**: 감정 교류, 로맨스, 상호 이해
- **높은 점수**: 같은 원소, 불+바람, 흙+물
- **낮은 점수**: 극단적 차이(불+물, 흙+바람)

#### 우정 궁합 (Friendship)
- **강점**: 공통 관심사, 소통, 신뢰
- **높은 점수**: 같은 원소, 바람끼리, 물끼리
- **낮은 점수**: 가치관 차이가 큰 조합

#### 업무 궁합 (Work)
- **강점**: 협업, 효율성, 목표 달성
- **높은 점수**: 흙+흙, 흙+물, 불+바람
- **낮은 점수**: 충돌 가능성 높은 조합

### 3. 전체 점수 계산

```python
totalScore = round((love + friendship + work) / 3)
```

**예시:**
```python
love = 82
friendship = 86
work = 70
totalScore = round((82 + 86 + 70) / 3) = 79
```

### 4. 점수 등급 해석

| 점수 범위 | 등급 | 의미 |
|-----------|------|------|
| 85-95 | 최상 | 천생연분, 완벽한 조화 |
| 75-84 | 상 | 매우 좋은 궁합, 적극 추천 |
| 70-74 | 중상 | 좋은 궁합, 노력하면 발전 |
| 65-69 | 중 | 보통 궁합, 이해와 배려 필요 |
| 60-64 | 중하 | 어려움 있음, 많은 노력 필요 |

---

## 메시지 작성 가이드

### 1. advice 필드 작성 규칙

#### 문장 구조
```
[별자리1]과 [별자리2]는 [관계 특징] 관계입니다.
```

#### 관계 특징 표현 예시

**긍정적 표현 (점수 75 이상)**
- "서로를 이해하고 존중하는"
- "함께 성장하는"
- "조화로운 에너지를 나누는"
- "서로에게 영감을 주는"
- "깊은 신뢰를 쌓아가는"
- "완벽한 균형을 이루는"
- "서로를 보완하는"
- "특별한 유대감을 형성하는"

**중립적 표현 (점수 70-74)**
- "서로 배우며 발전하는"
- "이해와 배려가 필요한"
- "노력으로 조화를 이루는"
- "서로를 존중하며 성장하는"

**주의 표현 (점수 60-69)**
- "서로 다른 매력으로 균형을 찾는"
- "이해와 소통이 중요한"
- "서로의 차이를 인정하며 발전하는"
- "꾸준한 노력이 필요한"

### 2. 실제 작성 예시

#### 예시 1: 같은 별자리 (자기 자신)
```json
{
  "1-1": {
    "totalScore": 78,
    "scores": {
      "love": 75,
      "friendship": 85,
      "work": 75
    },
    "advice": "양자리끼리는 서로를 깊이 이해하는 관계입니다.",
    "message": ""
  }
}
```

#### 예시 2: 같은 원소 (불+불)
```json
{
  "1-5": {
    "totalScore": 82,
    "scores": {
      "love": 85,
      "friendship": 82,
      "work": 78
    },
    "advice": "양자리와 사자자리는 서로에게 영감을 주는 관계입니다.",
    "message": ""
  }
}
```

#### 예시 3: 좋은 조화 (불+바람)
```json
{
  "1-3": {
    "totalScore": 85,
    "scores": {
      "love": 88,
      "friendship": 85,
      "work": 82
    },
    "advice": "양자리와 쌍둥이자리는 조화로운 에너지를 나누는 관계입니다.",
    "message": ""
  }
}
```

#### 예시 4: 도전적 조합 (불+물)
```json
{
  "1-4": {
    "totalScore": 72,
    "scores": {
      "love": 70,
      "friendship": 75,
      "work": 70
    },
    "advice": "양자리와 게자리는 서로 배우며 발전하는 관계입니다.",
    "message": ""
  }
}
```

### 3. 작성 시 주의사항

#### ✅ 권장
- 긍정적이고 건설적인 표현 사용
- 모든 별자리 조합을 존중하는 태도
- 점수와 메시지의 일관성 유지
- 구체적이지만 일반적인 조언

#### ❌ 금지
- 부정적이거나 비관적인 표현
- "절대 맞지 않는다" 같은 극단적 표현
- 특정 별자리를 비하하는 내용
- 과도하게 구체적인 개인정보 언급

---

## 검증 방법

### 1. 완전성 검증

**모든 78쌍 존재 확인:**
```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

compat = data.get('compatibility', {})
print(f'현재 궁합 데이터: {len(compat)}쌍')

expected = []
for i in range(1, 13):
    for j in range(i, 13):
        expected.append(f'{i}-{j}')

missing = [k for k in expected if k not in compat]
if missing:
    print(f'누락된 조합: {missing}')
else:
    print('✅ 모든 조합 존재')
"
```

### 2. 점수 범위 검증

```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

compat = data.get('compatibility', {})
errors = []

for key, value in compat.items():
    total = value.get('totalScore', 0)
    love = value['scores'].get('love', 0)
    friendship = value['scores'].get('friendship', 0)
    work = value['scores'].get('work', 0)

    if not (60 <= total <= 95):
        errors.append(f'{key}: totalScore {total} 범위 벗어남')
    if not (60 <= love <= 95):
        errors.append(f'{key}: love {love} 범위 벗어남')
    if not (60 <= friendship <= 95):
        errors.append(f'{key}: friendship {friendship} 범위 벗어남')
    if not (60 <= work <= 95):
        errors.append(f'{key}: work {work} 범위 벗어남')

if errors:
    for e in errors:
        print(e)
else:
    print('✅ 모든 점수 정상 범위')
"
```

### 3. 메시지 존재 확인

```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

compat = data.get('compatibility', {})
missing_advice = []

for key, value in compat.items():
    if not value.get('advice'):
        missing_advice.append(key)

if missing_advice:
    print(f'조언 메시지 없음: {missing_advice}')
else:
    print('✅ 모든 조합에 조언 메시지 존재')
"
```

### 4. 평균 점수 계산 검증

```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

compat = data.get('compatibility', {})
errors = []

for key, value in compat.items():
    love = value['scores']['love']
    friendship = value['scores']['friendship']
    work = value['scores']['work']
    expected_total = round((love + friendship + work) / 3)
    actual_total = value['totalScore']

    if expected_total != actual_total:
        errors.append(f'{key}: 계산값 {expected_total} != 실제값 {actual_total}')

if errors:
    for e in errors:
        print(e)
else:
    print('✅ 모든 전체 점수 계산 정확')
"
```

---

## 생성 스크립트 예시

### Python 자동 생성 스크립트

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import json

# 별자리 원소 정보
ELEMENTS = {
    1: 'fire', 2: 'earth', 3: 'air', 4: 'water',
    5: 'fire', 6: 'earth', 7: 'air', 8: 'water',
    9: 'fire', 10: 'earth', 11: 'air', 12: 'water'
}

ZODIAC_NAMES = {
    1: '양자리', 2: '황소자리', 3: '쌍둥이자리', 4: '게자리',
    5: '사자자리', 6: '처녀자리', 7: '천칭자리', 8: '전갈자리',
    9: '사수자리', 10: '염소자리', 11: '물병자리', 12: '물고기자리'
}

def calculate_compatibility(zodiac1, zodiac2):
    """원소 기반 궁합 점수 계산"""
    element1 = ELEMENTS[zodiac1]
    element2 = ELEMENTS[zodiac2]

    # 같은 별자리
    if zodiac1 == zodiac2:
        return {"love": 75, "friendship": 85, "work": 75}

    # 같은 원소
    if element1 == element2:
        return {"love": 80, "friendship": 85, "work": 75}

    # 불 + 바람
    if (element1, element2) in [('fire', 'air'), ('air', 'fire')]:
        return {"love": 85, "friendship": 82, "work": 80}

    # 흙 + 물
    if (element1, element2) in [('earth', 'water'), ('water', 'earth')]:
        return {"love": 80, "friendship": 85, "work": 85}

    # 기타 조합
    return {"love": 72, "friendship": 75, "work": 72}

def generate_advice(zodiac1, zodiac2, total_score):
    """조언 메시지 생성"""
    name1 = ZODIAC_NAMES[zodiac1]
    name2 = ZODIAC_NAMES[zodiac2]

    if total_score >= 85:
        trait = "완벽한 조화를 이루는"
    elif total_score >= 80:
        trait = "서로에게 영감을 주는"
    elif total_score >= 75:
        trait = "함께 성장하는"
    else:
        trait = "서로 배우며 발전하는"

    return f"{name1}과 {name2}는 {trait} 관계입니다."

# 모든 궁합 생성
compatibility_data = {}

for i in range(1, 13):
    for j in range(i, 13):
        key = f"{i}-{j}"
        scores = calculate_compatibility(i, j)
        total = round(sum(scores.values()) / 3)

        compatibility_data[key] = {
            "totalScore": total,
            "scores": scores,
            "advice": generate_advice(i, j, total),
            "message": ""
        }

# fortune-data.json 업데이트
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

data['compatibility'] = compatibility_data

with open('api/fortune-data.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

print(f"✅ {len(compatibility_data)}쌍 궁합 데이터 생성 완료")
```

---

**작성일**: 2025년 10월 16일
**버전**: 1.0
**참고**: 운세데이터_작성_메뉴얼.md
