# 별자리 운세 데이터 작성 메뉴얼

## 📋 목차
1. [개요](#개요)
2. [사전 준비](#사전-준비)
3. [일간 운세 생성](#일간-운세-생성)
4. [주간/월간/연간 운세 생성](#주간월간연간-운세-생성)
5. [데이터 검증](#데이터-검증)
6. [문장 작성 가이드](#문장-작성-가이드)
7. [트러블슈팅](#트러블슈팅)

---

## 개요

### 목적
신규 연도(예: 2026년)의 별자리 운세 데이터를 생성하여 운세 시스템에 적용

### 필요 파일
- `generate_ai_fortunes.py` - 일간 운세 생성 스크립트
- `generate_period_fortunes.py` - 주간/월간/연간 운세 생성 스크립트
- `api/fortune-data.json` - 운세 데이터 저장 파일

### 데이터 유형
| 유형 | 생성량 (12개 별자리 기준) | 파일 위치 |
|------|---------------------------|-----------|
| 일간 운세 | 365일 × 12 = 4,380개 | fortune-data.json > daily |
| 주간 운세 | 52주 × 12 = 624개 | fortune-data.json > weekly |
| 월간 운세 | 12개월 × 12 = 144개 | fortune-data.json > monthly |
| 연간 운세 | 1년 × 12 = 12개 | fortune-data.json > yearly |
| 궁합 | 78쌍 (변경 없음) | fortune-data.json > compatibility |

---

## 사전 준비

### 1. 작업 디렉토리 이동
```bash
cd /Volumes/X31/code/baal/zodiac-system
```

### 2. Python 환경 확인
```bash
python3 --version  # Python 3.7 이상 필요
```

### 3. 기존 데이터 백업
```bash
cp api/fortune-data.json api/fortune-data-backup-$(date +%Y%m%d).json
```

### 4. 데이터 파일 존재 확인
```bash
ls -lh api/fortune-data.json
```

---

## 일간 운세 생성

### 1. 스크립트 실행

**기본 명령어:**
```bash
python3 generate_ai_fortunes.py [시작날짜] [생성일수]
```

**2026년 전체 생성 예시:**
```bash
python3 generate_ai_fortunes.py 2026-01-01 365
```

**특정 기간만 생성 예시:**
```bash
# 2026년 1월만 생성 (31일)
python3 generate_ai_fortunes.py 2026-01-01 31

# 2026년 1분기 생성 (90일)
python3 generate_ai_fortunes.py 2026-01-01 90
```

### 2. 생성 프로세스

스크립트 실행 시 다음 과정이 진행됩니다:

1. **fortune-data.json 로드**
   - 기존 데이터를 읽어들임
   - daily 섹션 존재 여부 확인

2. **날짜별 반복 생성** (365일)
   - 각 날짜마다 12개 별자리 데이터 생성
   - 진행 상황 표시: `[2026-01-01] 양자리 생성 완료...`

3. **자동 저장**
   - 매 10일마다 자동 저장
   - 최종 완료 시 저장
   - 생성 완료 메시지: `✅ 365일 데이터 생성 완료`

### 3. 예상 소요 시간
- **전체 365일 생성**: 약 5-10분
- **한 달(31일) 생성**: 약 30초 ~ 1분

### 4. 일간 운세 데이터 구조

```json
{
  "daily": {
    "2026-01-01": {
      "1": {  // 양자리
        "overall": "전체운 메시지 (1-2문장)",
        "fortunes": {
          "love": "애정운 메시지 (2-3문장)",
          "money": "금전운 메시지 (2-3문장)",
          "work": "직장운 메시지 (2-3문장)",
          "health": "건강운 메시지 (2-3문장)"
        },
        "scores": {
          "overall": 75,
          "love": 80,
          "money": 70,
          "work": 85,
          "health": 78
        },
        "lucky": {
          "color": "파랑",
          "number": 7,
          "time": "오전 10-12시"
        },
        "advice": "한줄 조언",
        "source": "ai_creative"
      },
      "2": { /* 황소자리 */ },
      // ... 12개 별자리
    },
    "2026-01-02": { /* ... */ }
  }
}
```

---

## 주간/월간/연간 운세 생성

### 1. 스크립트 실행

**기본 명령어:**
```bash
python3 generate_period_fortunes.py [연도]
```

**2026년 생성 예시:**
```bash
python3 generate_period_fortunes.py 2026
```

### 2. 생성 프로세스

1. **주간 운세 생성** (52주)
   - 2026-W01 ~ 2026-W52
   - 각 주마다 시작일/종료일 계산
   - 12개 별자리별 데이터 생성

2. **월간 운세 생성** (12개월)
   - 2026-01 ~ 2026-12
   - 각 월마다 12개 별자리 데이터 생성

3. **연간 운세 생성** (1년)
   - 2026년
   - 12개 별자리 데이터 생성

### 3. 예상 소요 시간
- **전체 생성**: 약 1-2분

### 4. 데이터 구조

#### 주간 운세
```json
{
  "weekly": {
    "2026-W01": {
      "1": {  // 양자리
        "weekStart": "2026-01-05",
        "weekEnd": "2026-01-11",
        "theme": "도전의 주간",
        "overall": "주간 전체운 (2-3문장)",
        "fortunes": {
          "love": "주간 애정운",
          "money": "주간 금전운",
          "work": "주간 직장운",
          "health": "주간 건강운"
        },
        "keyDays": "화요일"
      }
    }
  }
}
```

#### 월간 운세
```json
{
  "monthly": {
    "2026-01": {
      "1": {  // 양자리
        "theme": "리더십의 달",
        "overall": "월간 전체운 (2-3문장)",
        "fortunes": {
          "love": "월간 애정운 (3-4문장)",
          "money": "월간 금전운 (3-4문장)",
          "work": "월간 직장운 (3-4문장)",
          "health": "월간 건강운 (3-4문장)"
        },
        "keyDates": "1일, 11일, 21일"
      }
    }
  }
}
```

#### 연간 운세
```json
{
  "yearly": {
    "2026": {
      "1": {  // 양자리
        "year": 2026,
        "theme": "시작과 성장의 해",
        "overall": "연간 전체운 (3-4문장)",
        "fortunes": {
          "love": "연간 애정운 (4-5문장)",
          "money": "연간 금전운 (4-5문장)",
          "work": "연간 직장운 (4-5문장)",
          "health": "연간 건강운 (4-5문장)"
        },
        "bestMonths": ["3월", "7월", "11월"],
        "challengingMonths": ["2월", "8월"],
        "keyAdvice": "핵심 조언"
      }
    }
  }
}
```

---

## 데이터 검증

### 1. 생성 개수 확인

```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

year = '2026'
print(f'=== {year}년 데이터 검증 ===')
print(f'일간: {len([k for k in data.get(\"daily\", {}).keys() if k.startswith(year)])}일')
print(f'주간: {len([k for k in data.get(\"weekly\", {}).keys() if k.startswith(year)])}주')
print(f'월간: {len([k for k in data.get(\"monthly\", {}).keys() if k.startswith(year)])}개월')
print(f'연간: {len([k for k in data.get(\"yearly\", {}).keys() if k == year])}년')
"
```

**예상 결과:**
```
=== 2026년 데이터 검증 ===
일간: 365일
주간: 52주
월간: 12개월
연간: 1년
```

### 2. JSON 유효성 검증

```bash
python3 -c "
import json
try:
    with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
        data = json.load(f)
    print('✅ JSON 파일 정상')
except json.JSONDecodeError as e:
    print(f'❌ JSON 오류: {e}')
"
```

### 3. 샘플 데이터 확인

```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 2026년 1월 1일 양자리 데이터 출력
sample = data['daily']['2026-01-01']['1']
print(json.dumps(sample, ensure_ascii=False, indent=2))
"
```

### 4. 별자리별 완전성 확인

```bash
python3 -c "
import json
with open('api/fortune-data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 특정 날짜의 모든 별자리 존재 확인
test_date = '2026-01-01'
zodiacs = data['daily'][test_date].keys()
print(f'{test_date} 별자리 개수: {len(zodiacs)}개')
print(f'별자리 ID: {sorted(zodiacs)}')

if len(zodiacs) == 12:
    print('✅ 모든 별자리 존재')
else:
    print('❌ 누락된 별자리 있음')
"
```

---

## 문장 작성 가이드

### 1. 문장 스타일

#### ✅ 권장 표현
- **종결어미**: "~예요", "~어요", "~죠"
- **긍정적 표현**: "좋아져요", "도움이 돼요", "발전해요"
- **구체적 조언**: "스트레칭으로 긴장을 풀어보세요"
- **감성적 표현**: "마음이 따뜻해져요", "에너지가 넘쳐요"

#### ❌ 금지 표현
- **명령형**: "~하세요", "~하십시오"
- **과거형**: "~했어요", "~였어요"
- **격식체**: "~합니다", "~입니다"
- **극단적 표현**: "절대", "반드시", "100%"
- **부정적 표현**: "실패할 거예요", "안 좋아요"

### 2. 별자리별 핵심 키워드

| 별자리 | 핵심 특성 | 강점 | 성장 포인트 |
|--------|-----------|------|-------------|
| 양자리 (1) | 도전적, 열정적 | 추진력 | 인내심 |
| 황소자리 (2) | 안정적, 실용적 | 인내심 | 유연성 |
| 쌍둥이자리 (3) | 호기심, 유연 | 적응력 | 집중력 |
| 게자리 (4) | 감성적, 보호 | 공감능력 | 독립성 |
| 사자자리 (5) | 자신감, 관대 | 카리스마 | 겸손 |
| 처녀자리 (6) | 분석적, 완벽 | 분석력 | 수용 |
| 천칭자리 (7) | 조화, 균형 | 균형감각 | 결단력 |
| 전갈자리 (8) | 열정, 집중 | 통찰력 | 개방성 |
| 사수자리 (9) | 자유, 모험 | 낙천성 | 책임감 |
| 염소자리 (10) | 책임, 야심 | 인내력 | 여유 |
| 물병자리 (11) | 독창적, 자유 | 독립성 | 소속감 |
| 물고기자리 (12) | 감수성, 직관 | 감수성 | 현실감 |

### 3. 행운의 요소 범위

#### 행운의 색
```python
colors = [
    "빨강", "주황", "노랑", "초록", "파랑", "남색", "보라",
    "분홍", "하늘색", "민트", "라벤더", "코랄", "금색", "은색",
    "흰색", "검정", "회색", "베이지", "갈색", "청록",
    "밝은 노랑", "밝은 파랑", "진회색", "전기색"
]
```

#### 행운의 숫자
```python
number = random.randint(1, 99)  # 1~99 사이
```

#### 행운의 시간
```python
times = [
    "오전 6-8시", "오전 8-10시", "오전 10-12시",
    "오후 12-2시", "오후 2-4시", "오후 4-6시",
    "오후 6-8시", "오후 8-10시", "오후 10-12시"
]
```

### 4. 점수 범위

```python
# 모든 점수는 60~95 사이
scores = {
    "overall": 60~95,
    "love": 60~95,
    "money": 60~95,
    "work": 60~95,
    "health": 60~95
}
```

---

## 트러블슈팅

### 문제 1: JSON 파싱 오류

**증상:**
```
json.decoder.JSONDecodeError: Expecting ',' delimiter
```

**원인:**
- JSON 문법 오류 (쉼표 누락, 따옴표 불일치 등)

**해결:**
1. 백업 파일로 복구
   ```bash
   cp api/fortune-data-backup-*.json api/fortune-data.json
   ```
2. JSON 검증 도구 사용
   ```bash
   python3 -m json.tool api/fortune-data.json > /dev/null
   ```

### 문제 2: 중복 데이터 생성

**증상:**
- 동일한 날짜에 데이터가 덮어씌워짐

**원인:**
- 스크립트 중복 실행

**해결:**
- 생성 전 기존 데이터 존재 여부 확인
- 필요시 기존 데이터 삭제 후 재생성

### 문제 3: 인코딩 문제

**증상:**
- 한글이 깨져서 표시됨

**원인:**
- UTF-8 인코딩 문제

**해결:**
```python
# 파일 저장 시 encoding='utf-8' 명시
with open('api/fortune-data.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, ensure_ascii=False, indent=2)
```

### 문제 4: 메모리 부족

**증상:**
- 스크립트 실행 중 멈춤

**원인:**
- fortune-data.json 파일 크기 과다 (수 년치 데이터 누적)

**해결:**
1. 불필요한 연도 데이터 삭제
2. 주기적으로 연도별로 파일 분리

---

## 체크리스트

### 데이터 생성 완료 체크리스트

- [ ] 일간 운세 365일 생성 완료
- [ ] 주간 운세 52주 생성 완료
- [ ] 월간 운세 12개월 생성 완료
- [ ] 연간 운세 1년 생성 완료
- [ ] JSON 유효성 검증 통과
- [ ] 샘플 데이터 확인 완료
- [ ] 별자리별 완전성 확인 완료
- [ ] 백업 파일 생성 완료
- [ ] API 테스트 완료
- [ ] 프론트엔드 동작 확인 완료

---

## 추가 참고 사항

### 생성 스크립트 커스터마이징

필요시 `generate_ai_fortunes.py`의 `ZODIAC_PROFILES` 섹션을 수정하여:
- 별자리 특성 추가/변경
- 키워드 업데이트
- 문장 패턴 추가

### 데이터 백업 전략

1. **생성 전 백업**: 신규 연도 데이터 생성 전 필수
2. **주기적 백업**: 매월 초 백업 권장
3. **버전 관리**: Git 등으로 변경 이력 관리

### API 연동 확인

데이터 생성 후 반드시 확인:
```bash
# 개발 서버 실행
cd api
node zodiac-api-final.js

# 브라우저에서 테스트
# http://localhost:3000/daily/2026-01-01/1
```

---

**작성일**: 2025년 10월 16일
**버전**: 1.0
**문의**: 프로젝트 관리자
