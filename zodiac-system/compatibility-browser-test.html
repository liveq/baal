<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¶í•© ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .test-controls { margin: 10px 0; }
        .result-display { margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; }
        select, button { padding: 8px 12px; margin: 5px; font-size: 14px; }
        button { background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .score { font-weight: bold; color: #28a745; }
        .description { margin: 10px 0; line-height: 1.6; }
        .log { font-family: monospace; font-size: 12px; margin: 5px 0; padding: 5px; background: #f1f3f4; }
    </style>
</head>
<body>
    <h1>ë³„ìë¦¬ ê¶í•© ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸</h1>

    <div class="test-section">
        <h2>ìˆ˜ë™ í…ŒìŠ¤íŠ¸</h2>
        <div class="test-controls">
            <label>ë‚´ ë³„ìë¦¬:
                <select id="myZodiac">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="1">ì–‘ìë¦¬</option>
                    <option value="2">í™©ì†Œìë¦¬</option>
                    <option value="3">ìŒë‘¥ì´ìë¦¬</option>
                    <option value="4">ê²Œìë¦¬</option>
                    <option value="5">ì‚¬ììë¦¬</option>
                    <option value="6">ì²˜ë…€ìë¦¬</option>
                    <option value="7">ì²œì¹­ìë¦¬</option>
                    <option value="8">ì „ê°ˆìë¦¬</option>
                    <option value="9">ì‚¬ìˆ˜ìë¦¬</option>
                    <option value="10">ì—¼ì†Œìë¦¬</option>
                    <option value="11">ë¬¼ë³‘ìë¦¬</option>
                    <option value="12">ë¬¼ê³ ê¸°ìë¦¬</option>
                </select>
            </label>

            <label>ìƒëŒ€ë°© ë³„ìë¦¬:
                <select id="partnerZodiac">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="1">ì–‘ìë¦¬</option>
                    <option value="2">í™©ì†Œìë¦¬</option>
                    <option value="3">ìŒë‘¥ì´ìë¦¬</option>
                    <option value="4">ê²Œìë¦¬</option>
                    <option value="5">ì‚¬ììë¦¬</option>
                    <option value="6">ì²˜ë…€ìë¦¬</option>
                    <option value="7">ì²œì¹­ìë¦¬</option>
                    <option value="8">ì „ê°ˆìë¦¬</option>
                    <option value="9">ì‚¬ìˆ˜ìë¦¬</option>
                    <option value="10">ì—¼ì†Œìë¦¬</option>
                    <option value="11">ë¬¼ë³‘ìë¦¬</option>
                    <option value="12">ë¬¼ê³ ê¸°ìë¦¬</option>
                </select>
            </label>

            <button onclick="testCompatibility()">ê¶í•© í™•ì¸</button>
        </div>

        <div id="manualResult" class="result-display" style="display: none;">
            <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <div class="test-section">
        <h2>ìë™ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤</h2>
        <button onclick="runAutoTests()">ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="autoTestResults"></div>
    </div>

    <div class="test-section">
        <h2>ìƒì„¸ ë¡œê·¸</h2>
        <button onclick="clearLogs()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        <div id="logs"></div>
    </div>

    <script src="api/zodiac-api-real.js"></script>
    <script>
        let originalConsoleLog = console.log;

        // ë¡œê·¸ ìºì²˜
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            const logDiv = document.createElement('div');
            logDiv.className = 'log';
            logDiv.textContent = args.join(' ');
            document.getElementById('logs').appendChild(logDiv);
        };

        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
        }

        async function testCompatibility() {
            const myZodiacId = parseInt(document.getElementById('myZodiac').value);
            const partnerZodiacId = parseInt(document.getElementById('partnerZodiac').value);

            if (!myZodiacId || !partnerZodiacId) {
                alert('ë‘ ë³„ìë¦¬ë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            console.log(`ğŸ§ª ìˆ˜ë™ í…ŒìŠ¤íŠ¸: ${myZodiacId} vs ${partnerZodiacId}`);

            try {
                const result = await zodiacAPI.getCompatibility(myZodiacId, partnerZodiacId);
                displayResult('manualResult', result, `${getZodiacName(myZodiacId)} vs ${getZodiacName(partnerZodiacId)}`);
            } catch (error) {
                console.error('âŒ ê¶í•© ì¡°íšŒ ì‹¤íŒ¨:', error);
                document.getElementById('manualResult').innerHTML = `<p style="color: red;">ì˜¤ë¥˜: ${error.message}</p>`;
                document.getElementById('manualResult').style.display = 'block';
            }
        }

        async function runAutoTests() {
            const testCases = [
                { z1: 1, z2: 4, name: 'ì–‘ìë¦¬-ê²Œìë¦¬ (ë¬¸ì œì˜€ë˜ ì¡°í•©)' },
                { z1: 11, z2: 5, name: 'ë¬¼ë³‘ìë¦¬-ì‚¬ììë¦¬' },
                { z1: 5, z2: 12, name: 'ì‚¬ììë¦¬-ë¬¼ê³ ê¸°ìë¦¬' },
                { z1: 1, z2: 1, name: 'ì–‘ìë¦¬-ì–‘ìë¦¬ (ê°™ì€ ë³„ìë¦¬)' }
            ];

            const resultsContainer = document.getElementById('autoTestResults');
            resultsContainer.innerHTML = '';

            for (const testCase of testCases) {
                console.log(`\nğŸ§ª ìë™ í…ŒìŠ¤íŠ¸: ${testCase.name}`);

                try {
                    const result = await zodiacAPI.getCompatibility(testCase.z1, testCase.z2);

                    const testDiv = document.createElement('div');
                    testDiv.className = 'result-display';
                    testDiv.innerHTML = `<h3>${testCase.name}</h3>`;

                    displayResult(testDiv, result, testCase.name);
                    resultsContainer.appendChild(testDiv);

                } catch (error) {
                    console.error(`âŒ ${testCase.name} í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:`, error);
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'result-display';
                    errorDiv.innerHTML = `<h3>${testCase.name}</h3><p style="color: red;">ì˜¤ë¥˜: ${error.message}</p>`;
                    resultsContainer.appendChild(errorDiv);
                }
            }
        }

        function displayResult(container, result, title) {
            const containerElement = typeof container === 'string' ?
                document.getElementById(container) : container;

            const html = `
                <h3>${title}</h3>
                <div class="score">ì´ì : ${result.totalScore}ì </div>
                <div style="margin: 10px 0;">
                    <span>ğŸ’– ì• ì •: ${result.scores?.love || 'N/A'}ì </span> |
                    <span>ğŸ¤ ìš°ì •: ${result.scores?.friendship || 'N/A'}ì </span> |
                    <span>ğŸ’¼ ì—…ë¬´: ${result.scores?.work || 'N/A'}ì </span>
                </div>
                <div class="description">
                    <strong>ì„¤ëª…:</strong><br>
                    ${result.description || 'ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.'}
                </div>
                <div style="margin-top: 10px;">
                    <strong>ì¡°ì–¸:</strong> ${result.advice || 'ì¡°ì–¸ì´ ì—†ìŠµë‹ˆë‹¤.'}
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: #666;">
                    <strong>ë°ì´í„° ì†ŒìŠ¤:</strong> ${result.source || 'unknown'}
                </div>
            `;

            if (typeof container === 'string') {
                containerElement.innerHTML = html;
                containerElement.style.display = 'block';
            } else {
                containerElement.innerHTML += html;
            }
        }

        function getZodiacName(id) {
            const names = {
                1: 'ì–‘ìë¦¬', 2: 'í™©ì†Œìë¦¬', 3: 'ìŒë‘¥ì´ìë¦¬', 4: 'ê²Œìë¦¬',
                5: 'ì‚¬ììë¦¬', 6: 'ì²˜ë…€ìë¦¬', 7: 'ì²œì¹­ìë¦¬', 8: 'ì „ê°ˆìë¦¬',
                9: 'ì‚¬ìˆ˜ìë¦¬', 10: 'ì—¼ì†Œìë¦¬', 11: 'ë¬¼ë³‘ìë¦¬', 12: 'ë¬¼ê³ ê¸°ìë¦¬'
            };
            return names[id] || `ë³„ìë¦¬${id}`;
        }

        // í˜ì´ì§€ ë¡œë“œ í›„ ìë™ìœ¼ë¡œ í•œ ë²ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('ğŸ¯ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ, API ì¤€ë¹„ ìƒíƒœ í™•ì¸');
                console.log('zodiacAPI ì¡´ì¬:', !!window.zodiacAPI);
                console.log('getCompatibility ë©”ì„œë“œ ì¡´ì¬:', !!(window.zodiacAPI && window.zodiacAPI.getCompatibility));
            }, 1000);
        });
    </script>
</body>
</html>