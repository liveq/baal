<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì ìˆ˜ ê¸°ë°˜ ì¸ë¬¼ ì„ íƒ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #718096;
            font-size: 1.1em;
        }
        
        .test-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }
        
        .control-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #4a5568;
        }
        
        .control-group select, 
        .control-group input {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            align-self: flex-end;
        }
        
        .test-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .results-container {
            margin-top: 30px;
        }
        
        .score-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .score-info h3 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
        }
        
        .score-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .score-item {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }
        
        .fortune-category {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .fortune-category:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }
        
        .category-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .category-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #2d3748;
        }
        
        .selected-figure {
            font-size: 0.9em;
            color: #667eea;
            font-weight: 500;
        }
        
        .fortune-text {
            font-size: 1.05em;
            line-height: 1.6;
            color: #4a5568;
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .debug-info {
            margin-top: 30px;
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .debug-info pre {
            margin: 0;
            white-space: pre-wrap;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
        }
        
        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #c53030;
        }
        
        .zodiac-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .zodiac-btn {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 15px 10px;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .zodiac-btn:hover {
            border-color: #667eea;
            background: #f7fafc;
        }
        
        .zodiac-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .score-range-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .range-card {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .range-card.high {
            background: linear-gradient(135deg, #48bb78 0%, #68d391 100%);
            color: white;
        }
        
        .range-card.medium {
            background: linear-gradient(135deg, #4299e1 0%, #63b3ed 100%);
            color: white;
        }
        
        .range-card.low {
            background: linear-gradient(135deg, #ed8936 0%, #f6ad55 100%);
            color: white;
        }
        
        .comparison-section {
            margin-top: 30px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
        }
        
        .comparison-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .comparison-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .comparison-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ ì ìˆ˜ ê¸°ë°˜ ì¸ë¬¼ ì„ íƒ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>
            <p>ì¹´í…Œê³ ë¦¬ ì ìˆ˜ í‰ê· ì— ë”°ë¼ í•´ë‹¹ ê·¸ë£¹ì˜ ì¸ë¬¼ë§Œ ì„ íƒí•˜ì—¬ ë©”ì‹œì§€ í†¤ ì¼ê´€ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤</p>
        </div>

        <div class="score-range-info">
            <div class="range-card high">
                <h3>ê³ ë“ì  ê·¸ë£¹ (85ì  ì´ìƒ)</h3>
                <p>ì„±ê³µì /ê¸ì •ì  ì¸ë¬¼ 88ëª…</p>
                <small>ë‚˜í´ë ˆì˜¹, ë ˆì˜¤ë‚˜ë¥´ë„ ë‹¤ë¹ˆì¹˜, ì•„ì¸ìŠˆíƒ€ì¸, ë² í† ë²¤ ë“±</small>
            </div>
            <div class="range-card medium">
                <h3>ì¤‘ê°„ì  ê·¸ë£¹ (70-84ì )</h3>
                <p>ê· í˜•ì /ì•ˆì •ì  ì¸ë¬¼ 112ëª…</p>
                <small>ê°„ë””, í†¨ìŠ¤í† ì´, í”„ë¡œì´ë“œ, ê³µì ë“±</small>
            </div>
            <div class="range-card low">
                <h3>ì €ë“ì  ê·¸ë£¹ (69ì  ì´í•˜)</h3>
                <p>ë„ì „ì /ê·¹ë³µí˜• ì¸ë¬¼ 40ëª…</p>
                <small>ë°˜ ê³ í, ì²´ ê²Œë°”ë¼, ë§ˆí‹´ ë£¨í„° í‚¹, ë„¬ìŠ¨ ë§Œë¸ë¼ ë“±</small>
            </div>
        </div>

        <div class="test-controls">
            <div class="control-group">
                <label>ë³„ìë¦¬ ì„ íƒ:</label>
                <select id="zodiacSelect">
                    <option value="1">ì–‘ìë¦¬ (â™ˆ)</option>
                    <option value="2">í™©ì†Œìë¦¬ (â™‰)</option>
                    <option value="3">ìŒë‘¥ì´ìë¦¬ (â™Š)</option>
                    <option value="4">ê²Œìë¦¬ (â™‹)</option>
                    <option value="5">ì‚¬ììë¦¬ (â™Œ)</option>
                    <option value="6">ì²˜ë…€ìë¦¬ (â™)</option>
                    <option value="7">ì²œì¹­ìë¦¬ (â™)</option>
                    <option value="8">ì „ê°ˆìë¦¬ (â™)</option>
                    <option value="9">ì‚¬ìˆ˜ìë¦¬ (â™)</option>
                    <option value="10">ì—¼ì†Œìë¦¬ (â™‘)</option>
                    <option value="11">ë¬¼ë³‘ìë¦¬ (â™’)</option>
                    <option value="12">ë¬¼ê³ ê¸°ìë¦¬ (â™“)</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>ì‹œë®¬ë ˆì´ì…˜ ì ìˆ˜:</label>
                <select id="scoreSimulation">
                    <option value="auto">ìë™ (ì‹¤ì œ ì ìˆ˜ ì‚¬ìš©)</option>
                    <option value="90">90ì  (ê³ ë“ì  ê·¸ë£¹)</option>
                    <option value="80">80ì  (ì¤‘ê°„ì  ê·¸ë£¹)</option>
                    <option value="65">65ì  (ì €ë“ì  ê·¸ë£¹)</option>
                </select>
            </div>

            <button class="test-button" onclick="testScoreBasedSystem()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <button class="test-button" onclick="runComparison()">ê·¸ë£¹ë³„ ë¹„êµ</button>
        </div>

        <div id="results" class="results-container" style="display: none;">
            <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>

        <div class="comparison-section">
            <h3>ğŸ” ì ìˆ˜ ê·¸ë£¹ë³„ ë©”ì‹œì§€ í†¤ ë¹„êµ</h3>
            <div class="comparison-controls">
                <button class="test-button" onclick="compareMessageTones()">ë©”ì‹œì§€ í†¤ ë¹„êµ ì‹¤í–‰</button>
            </div>
            <div id="comparisonResults" class="comparison-results">
                <!-- ë¹„êµ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- API ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script src="api/zodiac-api-final.js"></script>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentTestResults = null;

        // ì ìˆ˜ ê¸°ë°˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        async function testScoreBasedSystem() {
            const zodiacId = parseInt(document.getElementById('zodiacSelect').value);
            const scoreMode = document.getElementById('scoreSimulation').value;
            
            console.log(`ğŸ¯ ì ìˆ˜ ê¸°ë°˜ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘: ë³„ìë¦¬ ${zodiacId}, ì ìˆ˜ ëª¨ë“œ: ${scoreMode}`);
            
            // ë¡œë”© í‘œì‹œ
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</div>';

            try {
                // API í˜¸ì¶œ
                let fortune = await zodiacAPI.getDailyFortune(zodiacId);
                
                // ì ìˆ˜ ì‹œë®¬ë ˆì´ì…˜
                if (scoreMode !== 'auto') {
                    const simulatedScore = parseInt(scoreMode);
                    fortune.scores = {
                        love: simulatedScore,
                        money: simulatedScore,
                        work: simulatedScore,
                        health: simulatedScore
                    };
                    fortune.averageScore = simulatedScore;
                    fortune.scoreGroup = simulatedScore >= 85 ? 'high' : simulatedScore >= 70 ? 'medium' : 'low';
                    fortune.scoreGroupLabel = 
                        simulatedScore >= 85 ? 'ê³ ë“ì  ê·¸ë£¹ (ì„±ê³µì /ê¸ì •ì )' :
                        simulatedScore >= 70 ? 'ì¤‘ê°„ì  ê·¸ë£¹ (ê· í˜•ì /ì•ˆì •ì )' : 'ì €ë“ì  ê·¸ë£¹ (ë„ì „ì /ê·¹ë³µí˜•)';
                    console.log(`ğŸ“Š ì ìˆ˜ ì‹œë®¬ë ˆì´ì…˜: ${simulatedScore}ì  â†’ ${fortune.scoreGroup} ê·¸ë£¹`);
                }

                currentTestResults = fortune;
                displayResults(fortune);
                
            } catch (error) {
                console.error('âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
                resultsDiv.innerHTML = `<div class="error">í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</div>`;
            }
        }

        // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
        function displayResults(fortune) {
            const resultsDiv = document.getElementById('results');
            const zodiacName = getZodiacName(fortune.zodiacId);
            
            let html = `
                <div class="score-info">
                    <h3>${zodiacName} ì ìˆ˜ ê¸°ë°˜ ìš´ì„¸ ê²°ê³¼</h3>
                    <p><strong>í‰ê·  ì ìˆ˜:</strong> ${fortune.averageScore}ì </p>
                    <p><strong>ì„ íƒëœ ê·¸ë£¹:</strong> ${fortune.scoreGroupLabel}</p>
                    <div class="score-details">
                        <div class="score-item">
                            <strong>ì• ì •ìš´</strong><br>${fortune.scores.love}ì 
                        </div>
                        <div class="score-item">
                            <strong>ê¸ˆì „ìš´</strong><br>${fortune.scores.money}ì 
                        </div>
                        <div class="score-item">
                            <strong>ì§ì¥ìš´</strong><br>${fortune.scores.work}ì 
                        </div>
                        <div class="score-item">
                            <strong>ê±´ê°•ìš´</strong><br>${fortune.scores.health}ì 
                        </div>
                    </div>
                </div>
                
                <div class="fortune-category">
                    <div class="category-header">
                        <div class="category-title">ğŸ“‹ ì „ì²´ìš´</div>
                        <div class="selected-figure">${fortune.selectedFigures?.overall || 'N/A'}</div>
                    </div>
                    <div class="fortune-text">${fortune.overall}</div>
                </div>
            `;

            // ì¹´í…Œê³ ë¦¬ë³„ ìš´ì„¸ í‘œì‹œ
            if (fortune.fortunes) {
                const categoryIcons = {
                    love: 'â¤ï¸', money: 'ğŸ’°', work: 'ğŸ’¼', health: 'ğŸ¥'
                };
                const categoryNames = {
                    love: 'ì• ì •ìš´', money: 'ê¸ˆì „ìš´', work: 'ì§ì¥ìš´', health: 'ê±´ê°•ìš´'
                };

                Object.entries(fortune.fortunes).forEach(([category, message]) => {
                    const icon = categoryIcons[category] || 'â­';
                    const name = categoryNames[category] || category;
                    const figure = fortune.selectedFigures?.[category] || 'N/A';
                    
                    html += `
                        <div class="fortune-category">
                            <div class="category-header">
                                <div class="category-title">${icon} ${name}</div>
                                <div class="selected-figure">${figure}</div>
                            </div>
                            <div class="fortune-text">${message}</div>
                        </div>
                    `;
                });
            }

            // ì¡°ì–¸ í‘œì‹œ
            html += `
                <div class="fortune-category">
                    <div class="category-header">
                        <div class="category-title">ğŸ’¡ ì¡°ì–¸</div>
                        <div class="selected-figure">${fortune.selectedFigures?.advice || 'N/A'}</div>
                    </div>
                    <div class="fortune-text">${fortune.advice}</div>
                </div>
            `;

            // ë””ë²„ê·¸ ì •ë³´ í‘œì‹œ
            html += `
                <div class="debug-info">
                    <h4>ğŸ”§ ë””ë²„ê·¸ ì •ë³´</h4>
                    <pre>${JSON.stringify(fortune, null, 2)}</pre>
                </div>
            `;

            resultsDiv.innerHTML = html;
        }

        // ê·¸ë£¹ë³„ ë¹„êµ í…ŒìŠ¤íŠ¸
        async function runComparison() {
            const zodiacId = parseInt(document.getElementById('zodiacSelect').value);
            console.log('ğŸ”„ ê·¸ë£¹ë³„ ë¹„êµ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = '<div class="loading">ê·¸ë£¹ë³„ ë¹„êµ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...</div>';

            try {
                const testScores = [
                    { score: 90, group: 'high', label: 'ê³ ë“ì  ê·¸ë£¹' },
                    { score: 75, group: 'medium', label: 'ì¤‘ê°„ì  ê·¸ë£¹' },
                    { score: 65, group: 'low', label: 'ì €ë“ì  ê·¸ë£¹' }
                ];

                let comparisonHtml = `
                    <h2>ğŸ“Š ${getZodiacName(zodiacId)} ê·¸ë£¹ë³„ ë©”ì‹œì§€ í†¤ ë¹„êµ</h2>
                    <div class="comparison-results">
                `;

                for (const test of testScores) {
                    // ê° ê·¸ë£¹ë³„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                    const fortune = await zodiacAPI.getDailyFortune(zodiacId);
                    
                    // ì ìˆ˜ ì‹œë®¬ë ˆì´ì…˜
                    fortune.scores = { love: test.score, money: test.score, work: test.score, health: test.score };
                    fortune.averageScore = test.score;
                    fortune.scoreGroup = test.group;
                    fortune.scoreGroupLabel = test.label;

                    comparisonHtml += `
                        <div class="comparison-card">
                            <h3>${test.label} (${test.score}ì )</h3>
                            <div style="margin-bottom: 15px;">
                                <strong>ì „ì²´ìš´:</strong><br>
                                <em>${fortune.selectedFigures?.overall || 'N/A'}</em><br>
                                ${fortune.overall.substring(0, 100)}...
                            </div>
                            <div style="margin-bottom: 15px;">
                                <strong>ì• ì •ìš´:</strong><br>
                                <em>${fortune.selectedFigures?.love || 'N/A'}</em><br>
                                ${fortune.fortunes?.love?.substring(0, 100) || 'N/A'}...
                            </div>
                            <div>
                                <strong>ì¡°ì–¸:</strong><br>
                                <em>${fortune.selectedFigures?.advice || 'N/A'}</em><br>
                                ${fortune.advice.substring(0, 100)}...
                            </div>
                        </div>
                    `;
                }

                comparisonHtml += '</div>';
                resultsDiv.innerHTML = comparisonHtml;

            } catch (error) {
                console.error('âŒ ë¹„êµ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
                resultsDiv.innerHTML = `<div class="error">ë¹„êµ í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</div>`;
            }
        }

        // ë©”ì‹œì§€ í†¤ ë¹„êµ í•¨ìˆ˜
        async function compareMessageTones() {
            const comparisonDiv = document.getElementById('comparisonResults');
            comparisonDiv.innerHTML = '<div class="loading">ë©”ì‹œì§€ í†¤ ë¶„ì„ ì¤‘...</div>';

            try {
                const zodiacId = 1; // ì–‘ìë¦¬ë¡œ í…ŒìŠ¤íŠ¸
                const testGroups = [
                    { score: 90, group: 'high', color: '#48bb78' },
                    { score: 75, group: 'medium', color: '#4299e1' },
                    { score: 65, group: 'low', color: '#ed8936' }
                ];

                let html = '';
                
                for (const test of testGroups) {
                    const fortune = await zodiacAPI.getDailyFortune(zodiacId);
                    
                    html += `
                        <div class="comparison-card" style="border-left: 4px solid ${test.color};">
                            <h4>${test.group.toUpperCase()} ê·¸ë£¹ (${test.score}ì )</h4>
                            <div style="margin-bottom: 10px;">
                                <strong>ì„ íƒëœ ì¸ë¬¼:</strong> ${fortune.selectedFigures?.overall || 'N/A'}
                            </div>
                            <div style="background: #f8fafc; padding: 10px; border-radius: 6px;">
                                ${fortune.overall}
                            </div>
                        </div>
                    `;
                }

                comparisonDiv.innerHTML = html;

            } catch (error) {
                console.error('âŒ ë©”ì‹œì§€ í†¤ ë¹„êµ ì‹¤íŒ¨:', error);
                comparisonDiv.innerHTML = `<div class="error">ë©”ì‹œì§€ í†¤ ë¹„êµ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</div>`;
            }
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function getZodiacName(zodiacId) {
            const names = {
                1: 'ì–‘ìë¦¬', 2: 'í™©ì†Œìë¦¬', 3: 'ìŒë‘¥ì´ìë¦¬', 4: 'ê²Œìë¦¬',
                5: 'ì‚¬ììë¦¬', 6: 'ì²˜ë…€ìë¦¬', 7: 'ì²œì¹­ìë¦¬', 8: 'ì „ê°ˆìë¦¬',
                9: 'ì‚¬ìˆ˜ìë¦¬', 10: 'ì—¼ì†Œìë¦¬', 11: 'ë¬¼ë³‘ìë¦¬', 12: 'ë¬¼ê³ ê¸°ìë¦¬'
            };
            return names[zodiacId] || `ë³„ìë¦¬ ${zodiacId}`;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            console.log('ğŸš€ ì ìˆ˜ ê¸°ë°˜ ì¸ë¬¼ ì„ íƒ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            
            // API ë¡œë“œ ìƒíƒœ í™•ì¸
            if (typeof zodiacAPI !== 'undefined') {
                console.log('âœ… ZodiacAPI ë¡œë“œ ì™„ë£Œ');
            } else {
                console.error('âŒ ZodiacAPI ë¡œë“œ ì‹¤íŒ¨');
            }
        });
    </script>
</body>
</html>