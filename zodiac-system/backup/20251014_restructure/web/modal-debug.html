<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª¨ë‹¬ ë””ë²„ê¹… í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .debug-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-btn {
            padding: 10px 20px;
            margin: 5px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-btn:hover {
            background: #764ba2;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” ë³„ìë¦¬ ëª¨ë‹¬ ë””ë²„ê¹… í˜ì´ì§€</h1>
    
    <div class="debug-section">
        <h2>1. ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìƒíƒœ</h2>
        <div id="scriptStatus"></div>
    </div>
    
    <div class="debug-section">
        <h2>2. í•¨ìˆ˜ ì¡´ì¬ ì—¬ë¶€</h2>
        <div id="functionStatus"></div>
    </div>
    
    <div class="debug-section">
        <h2>3. zodiacDescriptions ë°ì´í„° ìƒíƒœ</h2>
        <div id="dataStatus"></div>
    </div>
    
    <div class="debug-section">
        <h2>4. DOM ìš”ì†Œ í™•ì¸</h2>
        <div id="domStatus"></div>
    </div>
    
    <div class="debug-section">
        <h2>5. ëª¨ë‹¬ í…ŒìŠ¤íŠ¸</h2>
        <button class="test-btn" onclick="testModal(1)">ì–‘ìë¦¬ ëª¨ë‹¬ í…ŒìŠ¤íŠ¸</button>
        <button class="test-btn" onclick="testModal(5)">ì‚¬ììë¦¬ ëª¨ë‹¬ í…ŒìŠ¤íŠ¸</button>
        <button class="test-btn" onclick="testModal(12)">ë¬¼ê³ ê¸°ìë¦¬ ëª¨ë‹¬ í…ŒìŠ¤íŠ¸</button>
        <div id="testResult"></div>
    </div>
    
    <div class="debug-section">
        <h2>6. ì½˜ì†” ë¡œê·¸</h2>
        <pre id="consoleLog"></pre>
    </div>
    
    <!-- ëª¨ë‹¬ HTML ë³µì‚¬ -->
    <div id="zodiacModal" class="zodiac-modal" style="display: none;" onclick="closeModalOnOutside(event)">
        <div class="modal-content">
            <button class="modal-close" onclick="closeZodiacModal()">Ã—</button>
            <h2 id="modalTitle" class="modal-title"></h2>
            <div id="modalBody" class="modal-body"></div>
        </div>
    </div>
    
    <!-- ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script src="../api/zodiac-api-real.js"></script>
    <script src="zodiac.js"></script>
    <script src="functions-fix.js"></script>
    <script src="init.js"></script>
    
    <script>
        // ì½˜ì†” ë¡œê·¸ ìº¡ì²˜
        const originalLog = console.log;
        const originalError = console.error;
        const logMessages = [];
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logMessages.push('[LOG] ' + args.join(' '));
            updateConsoleDisplay();
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logMessages.push('[ERROR] ' + args.join(' '));
            updateConsoleDisplay();
        };
        
        function updateConsoleDisplay() {
            const consoleDiv = document.getElementById('consoleLog');
            if (consoleDiv) {
                consoleDiv.textContent = logMessages.slice(-20).join('\n');
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ í›„ ìƒíƒœ ì²´í¬
        window.addEventListener('DOMContentLoaded', function() {
            checkStatus();
        });
        
        function checkStatus() {
            // 1. ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìƒíƒœ
            const scriptStatus = document.getElementById('scriptStatus');
            scriptStatus.innerHTML = `
                <div class="status ${typeof zodiacAPI !== 'undefined' ? 'success' : 'error'}">
                    zodiacAPI: ${typeof zodiacAPI !== 'undefined' ? 'âœ… ë¡œë“œë¨' : 'âŒ ì—†ìŒ'}
                </div>
            `;
            
            // 2. í•¨ìˆ˜ ì¡´ì¬ ì—¬ë¶€
            const functionStatus = document.getElementById('functionStatus');
            const functions = [
                'showZodiacModal',
                'closeZodiacModal',
                'closeModalOnOutside',
                'selectZodiac',
                'showIntroPage'
            ];
            
            let funcHtml = '';
            functions.forEach(func => {
                const exists = typeof window[func] === 'function';
                funcHtml += `<div class="status ${exists ? 'success' : 'error'}">
                    window.${func}: ${exists ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}
                </div>`;
            });
            functionStatus.innerHTML = funcHtml;
            
            // 3. zodiacDescriptions ë°ì´í„° ìƒíƒœ
            const dataStatus = document.getElementById('dataStatus');
            const dataInfo = {
                exists: !!window.zodiacDescriptions,
                type: typeof window.zodiacDescriptions,
                isNull: window.zodiacDescriptions === null,
                keys: window.zodiacDescriptions ? Object.keys(window.zodiacDescriptions).length : 0,
                sample: window.zodiacDescriptions && window.zodiacDescriptions[1] ? 
                    window.zodiacDescriptions[1].name : 'N/A'
            };
            
            dataStatus.innerHTML = `
                <div class="status ${dataInfo.exists && dataInfo.keys > 0 ? 'success' : 'error'}">
                    ì¡´ì¬: ${dataInfo.exists ? 'âœ…' : 'âŒ'}<br>
                    íƒ€ì…: ${dataInfo.type}<br>
                    null ì—¬ë¶€: ${dataInfo.isNull}<br>
                    í‚¤ ê°œìˆ˜: ${dataInfo.keys}<br>
                    ìƒ˜í”Œ ë°ì´í„°: ${dataInfo.sample}
                </div>
            `;
            
            // 4. DOM ìš”ì†Œ í™•ì¸
            const domStatus = document.getElementById('domStatus');
            const domElements = {
                modal: document.getElementById('zodiacModal'),
                title: document.getElementById('modalTitle'),
                body: document.getElementById('modalBody')
            };
            
            domStatus.innerHTML = `
                <div class="status ${domElements.modal && domElements.title && domElements.body ? 'success' : 'error'}">
                    #zodiacModal: ${domElements.modal ? 'âœ…' : 'âŒ'}<br>
                    #modalTitle: ${domElements.title ? 'âœ…' : 'âŒ'}<br>
                    #modalBody: ${domElements.body ? 'âœ…' : 'âŒ'}
                </div>
            `;
        }
        
        // ëª¨ë‹¬ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        function testModal(zodiacId) {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = '<div class="status info">ëª¨ë‹¬ ì—´ê¸° ì‹œë„ ì¤‘...</div>';
            
            try {
                if (typeof window.showZodiacModal === 'function') {
                    const result = window.showZodiacModal(zodiacId);
                    
                    setTimeout(() => {
                        const modal = document.getElementById('zodiacModal');
                        if (modal && modal.style.display === 'block') {
                            resultDiv.innerHTML = '<div class="status success">âœ… ëª¨ë‹¬ì´ ì„±ê³µì ìœ¼ë¡œ ì—´ë ¸ìŠµë‹ˆë‹¤!</div>';
                        } else {
                            resultDiv.innerHTML = '<div class="status error">âŒ ëª¨ë‹¬ì´ ì—´ë¦¬ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì½˜ì†” ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>';
                        }
                    }, 1500); // ì¬ì‹œë„ ë¡œì§ ëŒ€ê¸°
                } else {
                    resultDiv.innerHTML = '<div class="status error">âŒ showZodiacModal í•¨ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}</div>`;
            }
        }
        
        // 1ì´ˆë§ˆë‹¤ ìƒíƒœ ì—…ë°ì´íŠ¸
        setInterval(checkStatus, 1000);
    </script>
    
    <style>
        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        .zodiac-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease;
        }
        
        .modal-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            color: #000;
        }
    </style>
</body>
</html>